<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>RL.GPI</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/RL.GPI.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">haskell-rl-4.0: Haskell library for doing reinforcement learning.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) Target Corp. 2018</td></tr><tr><th>License</th><td>BSD-style (see the file LICENSE)</td></tr><tr><th>Maintainer</th><td>David.Banas@target.com</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Portability</th><td>?</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">RL.GPI</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#section.orphans">Orphan instances</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>A general policy iterator for reinforcement learning.</p><p>Developed while doing the exercises in Ch. 4-6 of the book
 <em>Reinforcement Learning: an Introduction</em>,
   Richard S. Sutton and Andrew G. Barto,
     The MIT Press,
       Cambridge, Massachusetts; London, England</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span> <a href="#t:HypParams">HypParams</a> r = <a href="#v:HypParams">HypParams</a> {<ul class="subs"><li><a href="#v:disc">disc</a> :: r</li><li><a href="#v:epsilon">epsilon</a> :: r</li><li><a href="#v:alpha">alpha</a> :: r</li><li><a href="#v:beta">beta</a> :: r</li><li><a href="#v:maxIter">maxIter</a> :: <a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a></li><li><a href="#v:tdStepType">tdStepType</a> :: <a href="RL-GPI.html#t:TDStep">TDStep</a></li><li><a href="#v:nSteps">nSteps</a> :: <a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a></li><li><a href="#v:mode">mode</a> :: <a href="RL-GPI.html#t:Mode">Mode</a></li></ul>}</li><li class="src short"><a href="#v:hypParamsDef">hypParamsDef</a> :: <a href="RL-GPI.html#t:HypParams">HypParams</a> <a href="../base-4.10.1.0/Prelude.html#t:Double">Double</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:TDStep">TDStep</a><ul class="subs"><li>= <a href="#v:Sarsa">Sarsa</a></li><li>| <a href="#v:Qlearn">Qlearn</a></li><li>| <a href="#v:ExpSarsa">ExpSarsa</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:Mode">Mode</a><ul class="subs"><li>= <a href="#v:MC">MC</a></li><li>| <a href="#v:TD">TD</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:Dbg">Dbg</a> s a r = <a href="#v:Dbg">Dbg</a> {<ul class="subs"><li><a href="#v:curSt">curSt</a> :: s</li><li><a href="#v:act">act</a> :: a</li><li><a href="#v:nxtSt">nxtSt</a> :: s</li><li><a href="#v:rwd">rwd</a> :: r</li><li><a href="#v:nxtStPrbs">nxtStPrbs</a> :: [(s, <a href="../base-4.10.1.0/Prelude.html#t:Double">Double</a>)]</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:TDRetT">TDRetT</a> s a r m n = <a href="#v:TDRetT">TDRetT</a> {<ul class="subs"><li><a href="#v:valFuncs">valFuncs</a> :: [s -&gt; r]</li><li><a href="#v:polFuncs">polFuncs</a> :: [s -&gt; a]</li><li><a href="#v:polXCnts">polXCnts</a> :: [<a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a>]</li><li><a href="#v:valErrs">valErrs</a> :: [r]</li><li><a href="#v:debugs">debugs</a> :: [[<a href="RL-GPI.html#t:Dbg">Dbg</a> s a r]]</li><li><a href="#v:qMats">qMats</a> :: [Vector m (Vector n (<a href="../base-4.10.1.0/Prelude.html#t:Double">Double</a>, <a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a>))]</li></ul>}</li><li class="src short"><a href="#v:doTD">doTD</a> :: <span class="keyword">forall</span> s. (<a href="RL-MDP.html#t:MDP">MDP</a> s, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> s, <a href="../base-4.10.1.0/Data-Eq.html#t:Eq">Eq</a> (<a href="RL-MDP.html#t:ActionT">ActionT</a> s), HasFin' s, HasFin' (<a href="RL-MDP.html#t:ActionT">ActionT</a> s)) =&gt; <a href="RL-GPI.html#t:HypParams">HypParams</a> <a href="../base-4.10.1.0/Prelude.html#t:Double">Double</a> -&gt; <a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="RL-GPI.html#t:TDRetT">TDRetT</a> s (<a href="RL-MDP.html#t:ActionT">ActionT</a> s) <a href="../base-4.10.1.0/Prelude.html#t:Double">Double</a> (Card s) (Card (<a href="RL-MDP.html#t:ActionT">ActionT</a> s))</li><li class="src short"><span class="keyword">type</span> <a href="#t:OptQT">OptQT</a> s g = (s, Vector (Card s) (Vector (Card (<a href="RL-MDP.html#t:ActionT">ActionT</a> s)) (<a href="../base-4.10.1.0/Prelude.html#t:Double">Double</a>, <a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a>)), g, [<a href="RL-GPI.html#t:Dbg">Dbg</a> s (<a href="RL-MDP.html#t:ActionT">ActionT</a> s) <a href="../base-4.10.1.0/Prelude.html#t:Double">Double</a>], <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)</li><li class="src short"><span class="keyword">type</span> <a href="#t:Unop">Unop</a> a = a -&gt; a</li><li class="src short"><a href="#v:optQn">optQn</a> :: (<a href="RL-MDP.html#t:MDP">MDP</a> s, HasFin' s, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> s, <a href="../base-4.10.1.0/Data-Eq.html#t:Eq">Eq</a> (<a href="RL-MDP.html#t:ActionT">ActionT</a> s), HasFin' (<a href="RL-MDP.html#t:ActionT">ActionT</a> s), RandomGen g) =&gt; <a href="RL-GPI.html#t:HypParams">HypParams</a> <a href="../base-4.10.1.0/Prelude.html#t:Double">Double</a> -&gt; <a href="RL-GPI.html#t:Unop">Unop</a> (<a href="RL-GPI.html#t:OptQT">OptQT</a> s g)</li><li class="src short"><a href="#v:optPol">optPol</a> :: (<a href="RL-MDP.html#t:MDP">MDP</a> s, <a href="../base-4.10.1.0/Data-Eq.html#t:Eq">Eq</a> s, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> s, HasTrie s, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> (<a href="RL-MDP.html#t:ActionT">ActionT</a> s), HasTrie (<a href="RL-MDP.html#t:ActionT">ActionT</a> s)) =&gt; <a href="RL-GPI.html#t:HypParams">HypParams</a> <a href="../base-4.10.1.0/Prelude.html#t:Double">Double</a> -&gt; (s -&gt; (<a href="RL-MDP.html#t:ActionT">ActionT</a> s, <a href="../base-4.10.1.0/Prelude.html#t:Double">Double</a>), [<a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a>]) -&gt; (s -&gt; (<a href="RL-MDP.html#t:ActionT">ActionT</a> s, <a href="../base-4.10.1.0/Prelude.html#t:Double">Double</a>), [<a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a>])</li><li class="src short"><a href="#v:runEpisode">runEpisode</a> :: <a href="../base-4.10.1.0/Data-Eq.html#t:Eq">Eq</a> s =&gt; <a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a> -&gt; (s -&gt; a) -&gt; (s -&gt; a -&gt; s) -&gt; [s] -&gt; s -&gt; [s]</li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:HypParams" class="def">HypParams</a> r <a href="src/RL.GPI.html#HypParams" class="link">Source</a> <a href="#t:HypParams" class="selflink">#</a></p><div class="doc"><p>Hyper-parameters</p><p>The stated intents of the various fields are correct for the <code><code><a href="RL-GPI.html#v:optPol">optPol</a></code></code>
 function, which was the first solver written and performs dynamic
 programming (DP).</p><p>Some fields have overloaded meanings/uses, depending upon whether
 we're <code>optPol</code>ing, <code>optQ</code>ing, or ...
 Individual functions below call out such differences in their header
 commentary as appropriate.</p><p>The type parameter <code>r</code> should be equal to the reward type of the MDP
 being solved.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:HypParams" class="def">HypParams</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:disc" class="def">disc</a> :: r</dfn><div class="doc"><p>discount rate</p></div></li><li><dfn class="src"><a id="v:epsilon" class="def">epsilon</a> :: r</dfn><div class="doc"><p>convergence tolerance</p></div></li><li><dfn class="src"><a id="v:alpha" class="def">alpha</a> :: r</dfn><div class="doc"><p>error correction gain</p></div></li><li><dfn class="src"><a id="v:beta" class="def">beta</a> :: r</dfn><div class="doc"><p>epsilon/alpha decay factor</p></div></li><li><dfn class="src"><a id="v:maxIter" class="def">maxIter</a> :: <a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a></dfn><div class="doc"><p>max. value function evaluation iterations</p></div></li><li><dfn class="src"><a id="v:tdStepType" class="def">tdStepType</a> :: <a href="RL-GPI.html#t:TDStep">TDStep</a></dfn><div class="doc"><p>temporal difference step type</p></div></li><li><dfn class="src"><a id="v:nSteps" class="def">nSteps</a> :: <a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a></dfn><div class="doc"><p># of steps in n-step TD</p></div></li><li><dfn class="src"><a id="v:mode" class="def">mode</a> :: <a href="RL-GPI.html#t:Mode">Mode</a></dfn><div class="doc"><p>optimization mode</p></div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><a id="v:hypParamsDef" class="def">hypParamsDef</a> :: <a href="RL-GPI.html#t:HypParams">HypParams</a> <a href="../base-4.10.1.0/Prelude.html#t:Double">Double</a> <a href="src/RL.GPI.html#hypParamsDef" class="link">Source</a> <a href="#v:hypParamsDef" class="selflink">#</a></p><div class="doc"><p>A default value of type <code>HypParams</code>, to use as a starting point.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:TDStep" class="def">TDStep</a> <a href="src/RL.GPI.html#TDStep" class="link">Source</a> <a href="#t:TDStep" class="selflink">#</a></p><div class="doc"><p>Type of temporal difference (TD) step.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Sarsa" class="def">Sarsa</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Qlearn" class="def">Qlearn</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:ExpSarsa" class="def">ExpSarsa</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Mode" class="def">Mode</a> <a href="src/RL.GPI.html#Mode" class="link">Source</a> <a href="#t:Mode" class="selflink">#</a></p><div class="doc"><p>Optimization mode.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:MC" class="def">MC</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:TD" class="def">TD</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:Mode" class="caption collapser" onclick="toggleSection('i:Mode')">Instances</p><div id="section.i:Mode" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Mode:Eq:1" class="instance expander" onclick="toggleSection('i:id:Mode:Eq:1')"></span> <a href="../base-4.10.1.0/Data-Eq.html#t:Eq">Eq</a> <a href="RL-GPI.html#t:Mode">Mode</a></span> <a href="src/RL.GPI.html#line-113" class="link">Source</a> <a href="#t:Mode" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Mode:Eq:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="RL-GPI.html#t:Mode">Mode</a> -&gt; <a href="RL-GPI.html#t:Mode">Mode</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="RL-GPI.html#t:Mode">Mode</a> -&gt; <a href="RL-GPI.html#t:Mode">Mode</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Mode:Show:2" class="instance expander" onclick="toggleSection('i:id:Mode:Show:2')"></span> <a href="../base-4.10.1.0/Text-Show.html#t:Show">Show</a> <a href="RL-GPI.html#t:Mode">Mode</a></span> <a href="src/RL.GPI.html#line-113" class="link">Source</a> <a href="#t:Mode" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Mode:Show:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="RL-GPI.html#t:Mode">Mode</a> -&gt; <a href="../base-4.10.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="RL-GPI.html#t:Mode">Mode</a> -&gt; <a href="../base-4.10.1.0/Data-String.html#t:String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="RL-GPI.html#t:Mode">Mode</a>] -&gt; <a href="../base-4.10.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Dbg" class="def">Dbg</a> s a r <a href="src/RL.GPI.html#Dbg" class="link">Source</a> <a href="#t:Dbg" class="selflink">#</a></p><div class="doc"><p>Abstract type for capturing debugging information.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Dbg" class="def">Dbg</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:curSt" class="def">curSt</a> :: s</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:act" class="def">act</a> :: a</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:nxtSt" class="def">nxtSt</a> :: s</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:rwd" class="def">rwd</a> :: r</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:nxtStPrbs" class="def">nxtStPrbs</a> :: [(s, <a href="../base-4.10.1.0/Prelude.html#t:Double">Double</a>)]</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><p id="control.i:Dbg" class="caption collapser" onclick="toggleSection('i:Dbg')">Instances</p><div id="section.i:Dbg" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Dbg:Show:1" class="instance expander" onclick="toggleSection('i:id:Dbg:Show:1')"></span> (<a href="../base-4.10.1.0/Text-Show.html#t:Show">Show</a> r, <a href="../base-4.10.1.0/Text-Show.html#t:Show">Show</a> a, <a href="../base-4.10.1.0/Text-Show.html#t:Show">Show</a> s) =&gt; <a href="../base-4.10.1.0/Text-Show.html#t:Show">Show</a> (<a href="RL-GPI.html#t:Dbg">Dbg</a> s a r)</span> <a href="src/RL.GPI.html#line-122" class="link">Source</a> <a href="#t:Dbg" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Dbg:Show:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="RL-GPI.html#t:Dbg">Dbg</a> s a r -&gt; <a href="../base-4.10.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="RL-GPI.html#t:Dbg">Dbg</a> s a r -&gt; <a href="../base-4.10.1.0/Data-String.html#t:String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="RL-GPI.html#t:Dbg">Dbg</a> s a r] -&gt; <a href="../base-4.10.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:TDRetT" class="def">TDRetT</a> s a r m n <a href="src/RL.GPI.html#TDRetT" class="link">Source</a> <a href="#t:TDRetT" class="selflink">#</a></p><div class="doc"><p>Abstract type of return value from <code><code><a href="RL-GPI.html#v:doTD">doTD</a></code></code> function.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:TDRetT" class="def">TDRetT</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:valFuncs" class="def">valFuncs</a> :: [s -&gt; r]</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:polFuncs" class="def">polFuncs</a> :: [s -&gt; a]</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:polXCnts" class="def">polXCnts</a> :: [<a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a>]</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:valErrs" class="def">valErrs</a> :: [r]</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:debugs" class="def">debugs</a> :: [[<a href="RL-GPI.html#t:Dbg">Dbg</a> s a r]]</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:qMats" class="def">qMats</a> :: [Vector m (Vector n (<a href="../base-4.10.1.0/Prelude.html#t:Double">Double</a>, <a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a>))]</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><a id="v:doTD" class="def">doTD</a> <a href="src/RL.GPI.html#doTD" class="link">Source</a> <a href="#v:doTD" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="RL-MDP.html#t:MDP">MDP</a> s, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> s, <a href="../base-4.10.1.0/Data-Eq.html#t:Eq">Eq</a> (<a href="RL-MDP.html#t:ActionT">ActionT</a> s), HasFin' s, HasFin' (<a href="RL-MDP.html#t:ActionT">ActionT</a> s))</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="RL-GPI.html#t:HypParams">HypParams</a> <a href="../base-4.10.1.0/Prelude.html#t:Double">Double</a></td><td class="doc"><p>Simulation hyper-parameters.</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>Number of episodes to run.</p></td></tr><tr><td class="src">-&gt; <a href="RL-GPI.html#t:TDRetT">TDRetT</a> s (<a href="RL-MDP.html#t:ActionT">ActionT</a> s) <a href="../base-4.10.1.0/Prelude.html#t:Double">Double</a> (Card s) (Card (<a href="RL-MDP.html#t:ActionT">ActionT</a> s))</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Find optimum policy and value functions, using temporal difference.</p><p>This is intended to be the function called by client code wishing to
 perform temporal difference based policy optimization.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:OptQT" class="def">OptQT</a> s g = (s, Vector (Card s) (Vector (Card (<a href="RL-MDP.html#t:ActionT">ActionT</a> s)) (<a href="../base-4.10.1.0/Prelude.html#t:Double">Double</a>, <a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a>)), g, [<a href="RL-GPI.html#t:Dbg">Dbg</a> s (<a href="RL-MDP.html#t:ActionT">ActionT</a> s) <a href="../base-4.10.1.0/Prelude.html#t:Double">Double</a>], <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>) <a href="src/RL.GPI.html#OptQT" class="link">Source</a> <a href="#t:OptQT" class="selflink">#</a></p><div class="doc"><p>Object of <code><code><a href="RL-GPI.html#v:optQn">optQn</a></code></code> function.</p><p>Tuple element descriptions:</p><ul><li>Current state.</li><li>Augmented matrix representation of Q(s,a). Cell type: (value, # of adjustments).</li><li>Random number generator.</li><li>List of debugging data structures.</li><li>Simulation time in units of state transitions.</li></ul></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Unop" class="def">Unop</a> a = a -&gt; a <a href="src/RL.GPI.html#Unop" class="link">Source</a> <a href="#t:Unop" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:optQn" class="def">optQn</a> <a href="src/RL.GPI.html#optQn" class="link">Source</a> <a href="#v:optQn" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="RL-MDP.html#t:MDP">MDP</a> s, HasFin' s, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> s, <a href="../base-4.10.1.0/Data-Eq.html#t:Eq">Eq</a> (<a href="RL-MDP.html#t:ActionT">ActionT</a> s), HasFin' (<a href="RL-MDP.html#t:ActionT">ActionT</a> s), RandomGen g)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="RL-GPI.html#t:HypParams">HypParams</a> <a href="../base-4.10.1.0/Prelude.html#t:Double">Double</a></td><td class="doc"><p>Simulation hyper-parameters.</p></td></tr><tr><td class="src">-&gt; <a href="RL-GPI.html#t:Unop">Unop</a> (<a href="RL-GPI.html#t:OptQT">OptQT</a> s g)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Yields a single episodic action-value improvement iteration, using n-step TD.</p><p><code><code><a href="RL-GPI.html#t:HypParams">HypParams</a></code></code> field overrides:</p><ul><li><code>epsilon</code>: Used to form an &quot;epsilon-greedy&quot; policy.</li></ul><p>This function accomodates the <em>Monte Carlo</em> (MC) method by using the
following method of mean calculation, which has the same form as
temporal difference (TD) error correction:</p><p>\[
y = f(x) \z = g(y)</p><p>\]</p></div></div><div class="top"><p class="src"><a id="v:optPol" class="def">optPol</a> <a href="src/RL.GPI.html#optPol" class="link">Source</a> <a href="#v:optPol" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="RL-MDP.html#t:MDP">MDP</a> s, <a href="../base-4.10.1.0/Data-Eq.html#t:Eq">Eq</a> s, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> s, HasTrie s, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> (<a href="RL-MDP.html#t:ActionT">ActionT</a> s), HasTrie (<a href="RL-MDP.html#t:ActionT">ActionT</a> s))</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="RL-GPI.html#t:HypParams">HypParams</a> <a href="../base-4.10.1.0/Prelude.html#t:Double">Double</a></td><td class="doc"><p>Simulation hyper-parameters.</p></td></tr><tr><td class="src">-&gt; (s -&gt; (<a href="RL-MDP.html#t:ActionT">ActionT</a> s, <a href="../base-4.10.1.0/Prelude.html#t:Double">Double</a>), [<a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a>])</td><td class="doc"><p>initial policy &amp; value functions</p></td></tr><tr><td class="src">-&gt; (s -&gt; (<a href="RL-MDP.html#t:ActionT">ActionT</a> s, <a href="../base-4.10.1.0/Prelude.html#t:Double">Double</a>), [<a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a>])</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Yields a single policy improvment iteration.</p><p><code><code><a href="RL-GPI.html#t:HypParams">HypParams</a></code></code> field overrides:</p><ul><li><code>maxIter</code>: max. policy evaluation iterations (0 = Value Iteration)</li></ul><p>Returns a combined policy &amp; value function.</p></div></div><div class="top"><p class="src"><a id="v:runEpisode" class="def">runEpisode</a> <a href="src/RL.GPI.html#runEpisode" class="link">Source</a> <a href="#v:runEpisode" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../base-4.10.1.0/Data-Eq.html#t:Eq">Eq</a> s</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>Max. state transitions</p></td></tr><tr><td class="src">-&gt; (s -&gt; a)</td><td class="doc"><p>Policy</p></td></tr><tr><td class="src">-&gt; (s -&gt; a -&gt; s)</td><td class="doc"><p>Next state calculator</p></td></tr><tr><td class="src">-&gt; [s]</td><td class="doc"><p>Terminal states</p></td></tr><tr><td class="src">-&gt; s</td><td class="doc"><p>Initial state</p></td></tr><tr><td class="src">-&gt; [s]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Run one episode of a MDP, returning the list of states visited.</p></div></div><h1>Orphan instances</h1><div id="section.orphans" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:o:ic:HasTrie:HasTrie:1" class="instance expander" onclick="toggleSection('i:o:ic:HasTrie:HasTrie:1')"></span> <a href="../base-4.10.1.0/GHC-TypeNats.html#t:KnownNat">KnownNat</a> n =&gt; HasTrie (<a href="../finite-typelits-0.1.3.0/Data-Finite-Internal.html#t:Finite">Finite</a> n)</span> <a href="src/RL.GPI.html#line-58" class="link">Source</a> <a href="#v:-36-fHasTrieFinite" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:o:ic:HasTrie:HasTrie:1" class="inst-details hide"><div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">data</span> (<a href="../finite-typelits-0.1.3.0/Data-Finite-Internal.html#t:Finite">Finite</a> n) :-&gt;: b :: <a href="../base-4.10.1.0/Data-Kind.html#t:-42-">*</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:trie">trie</a> :: (<a href="../finite-typelits-0.1.3.0/Data-Finite-Internal.html#t:Finite">Finite</a> n -&gt; b) -&gt; <a href="../finite-typelits-0.1.3.0/Data-Finite-Internal.html#t:Finite">Finite</a> n :-&gt;: b</p><p class="src"><a href="#v:untrie">untrie</a> :: (<a href="../finite-typelits-0.1.3.0/Data-Finite-Internal.html#t:Finite">Finite</a> n :-&gt;: b) -&gt; <a href="../finite-typelits-0.1.3.0/Data-Finite-Internal.html#t:Finite">Finite</a> n -&gt; b</p><p class="src"><a href="#v:enumerate">enumerate</a> :: (<a href="../finite-typelits-0.1.3.0/Data-Finite-Internal.html#t:Finite">Finite</a> n :-&gt;: b) -&gt; [(<a href="../finite-typelits-0.1.3.0/Data-Finite-Internal.html#t:Finite">Finite</a> n, b)]</p></div></div></td></tr></table></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.18.1</p></div></body></html>